<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#17212b">
    <title>Telegram Test</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #17212b;
            color: #ffffff;
        }
        .container {
            max-width: 400px;
            margin: 0 auto;
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            font-weight: bold;
        }
        .success { background-color: #28a745; }
        .error { background-color: #dc3545; }
        .info { background-color: #17a2b8; }
        .user-info {
            background-color: #2c3e50;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .test-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Telegram Web App Test</h1>
        
        <div id="status" class="status info">
            –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...
        </div>
        
        <div id="user-info" class="user-info" style="display: none;">
            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:</h3>
            <div id="user-details"></div>
        </div>
        
        <div id="test-buttons" style="display: none;">
            <h3>–¢–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:</h3>
            <button class="test-button" onclick="testAlert()">–ü–æ–∫–∞–∑–∞—Ç—å Alert</button>
            <button class="test-button" onclick="testHaptic()">Haptic Feedback</button>
            <button class="test-button" onclick="testExpand()">–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å</button>
            <button class="test-button" onclick="testClose()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
        
        <div id="debug-info" style="margin-top: 20px; padding: 10px; background-color: #34495e; border-radius: 5px; font-size: 12px;">
            <h4>–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>
            <div id="debug-details"></div>
        </div>
    </div>

    <script>
        let webApp = null;
        let user = null;
        
        function updateStatus(message, type) {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
        }
        
        function updateDebugInfo() {
            const debugEl = document.getElementById('debug-details');
            debugEl.innerHTML = `
                <div>WebApp –¥–æ—Å—Ç—É–ø–µ–Ω: ${webApp ? '–î–∞' : '–ù–µ—Ç'}</div>
                <div>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${user ? user.first_name : '–ù–µ—Ç'}</div>
                <div>User Agent: ${navigator.userAgent}</div>
                <div>URL: ${window.location.href}</div>
                <div>Referrer: ${document.referrer || '–ù–µ—Ç'}</div>
                <div>Telegram Web App: ${window.Telegram ? '–î–æ—Å—Ç—É–ø–µ–Ω' : '–ù–µ–¥–æ—Å—Ç—É–ø–µ–Ω'}</div>
            `;
        }
        
        function testAlert() {
            if (webApp) {
                webApp.showAlert('–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!');
            } else {
                alert('–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ!');
            }
        }
        
        function testHaptic() {
            if (webApp && webApp.HapticFeedback) {
                webApp.HapticFeedback.impactOccurred('medium');
            }
        }
        
        function testExpand() {
            if (webApp) {
                webApp.expand();
            }
        }
        
        function testClose() {
            if (webApp) {
                webApp.close();
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded');
            updateDebugInfo();
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º Telegram Web App
                if (window.Telegram && window.Telegram.WebApp) {
                    webApp = window.Telegram.WebApp;
                    console.log('Telegram Web App found:', webApp);
                    
                    updateStatus('Telegram Web App –Ω–∞–π–¥–µ–Ω!', 'success');
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º Web App
                    webApp.ready();
                    webApp.expand();
                    webApp.setHeaderColor('#17212b');
                    webApp.setBackgroundColor('#17212b');
                    
                    // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    if (webApp.initDataUnsafe && webApp.initDataUnsafe.user) {
                        user = webApp.initDataUnsafe.user;
                        console.log('User data:', user);
                        
                        document.getElementById('user-info').style.display = 'block';
                        document.getElementById('user-details').innerHTML = `
                            <div><strong>–ò–º—è:</strong> ${user.first_name}</div>
                            <div><strong>–§–∞–º–∏–ª–∏—è:</strong> ${user.last_name || '–ù–µ—Ç'}</div>
                            <div><strong>Username:</strong> ${user.username || '–ù–µ—Ç'}</div>
                            <div><strong>ID:</strong> ${user.id}</div>
                        `;
                        
                        updateStatus('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 'success');
                    } else {
                        updateStatus('–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã', 'error');
                    }
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏
                    document.getElementById('test-buttons').style.display = 'block';
                    
                } else {
                    updateStatus('Telegram Web App –Ω–µ –Ω–∞–π–¥–µ–Ω (—Ä–∞–±–æ—Ç–∞–µ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ)', 'error');
                    console.log('Telegram Web App not found');
                }
                
            } catch (error) {
                console.error('Error:', error);
                updateStatus('–û—à–∏–±–∫–∞: ' + error.message, 'error');
            }
            
            updateDebugInfo();
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
        setInterval(updateDebugInfo, 5000);
    </script>
</body>
</html> 