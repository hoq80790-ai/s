# Настройка Telegram бота для Web App

## Проблема
Netlify может блокировать подключение к Telegram Web App из-за заголовков безопасности.

## Решение

### 1. Исправлена конфигурация Netlify
Убран заголовок `X-Frame-Options = "DENY"` из `netlify.toml`, который блокировал загрузку в iframe.

### 2. Создана тестовая страница
Файл `telegram-test.html` для проверки подключения к Telegram Web App.

## Настройка бота в @BotFather

### Шаг 1: Создание бота
1. Откройте @BotFather в Telegram
2. Отправьте `/newbot`
3. Введите имя бота (например: "Gift Bot")
4. Введите username бота (например: "gift_test_bot")

### Шаг 2: Настройка Web App
1. Отправьте `/mybots` в @BotFather
2. Выберите вашего бота
3. Нажмите "Bot Settings"
4. Выберите "Menu Button"
5. Введите текст кнопки (например: "Открыть приложение")
6. Введите URL вашего сайта на Netlify:
   ```
   https://your-site-name.netlify.app
   ```

### Шаг 3: Альтернативный способ
Если Menu Button не работает, используйте команду:
```
/setmenubutton
```
Затем выберите бота и введите URL.

## Тестирование

### 1. Тестовая страница
Откройте в браузере:
```
https://your-site-name.netlify.app/telegram-test.html
```

### 2. В Telegram
1. Найдите вашего бота
2. Нажмите кнопку "Открыть приложение"
3. Проверьте, что тестовая страница загружается

### 3. Проверка отладочной информации
На тестовой странице должна появиться информация:
- ✅ "Telegram Web App найден!"
- ✅ Данные пользователя
- ✅ Тестовые кнопки работают

## Возможные проблемы

### Проблема: "Telegram Web App не найден"
**Решение:**
1. Убедитесь, что сайт открыт через бота, а не в браузере
2. Проверьте URL в настройках бота
3. Убедитесь, что сайт доступен по HTTPS

### Проблема: Сайт не загружается
**Решение:**
1. Проверьте, что Netlify деплой прошел успешно
2. Убедитесь, что домен правильно настроен
3. Проверьте консоль браузера на ошибки

### Проблема: "Ошибка подключения"
**Решение:**
1. Проверьте, что заголовок `X-Frame-Options` убран
2. Убедитесь, что сайт не блокирует iframe
3. Проверьте CORS настройки

## Проверка заголовков

### Правильные заголовки для Telegram Web App:
```
X-Frame-Options: (отсутствует или ALLOW-FROM https://web.telegram.org)
Content-Security-Policy: (не должен блокировать frame-ancestors)
```

### Неправильные заголовки:
```
X-Frame-Options: DENY
Content-Security-Policy: frame-ancestors 'none'
```

## Команды для проверки

### Проверка заголовков:
```bash
curl -I https://your-site-name.netlify.app
```

### Проверка доступности:
```bash
curl https://your-site-name.netlify.app/telegram-test.html
```

## Следующие шаги

1. **Задеплойте исправленную версию** на Netlify
2. **Настройте бота** в @BotFather
3. **Протестируйте тестовую страницу** в браузере
4. **Протестируйте через бота** в Telegram
5. **Если тестовая страница работает** - протестируйте основное приложение

## Дата создания
$(date) 